/* === 1. 디자인 토큰 (변수 설정) === */
:root {
  --bg: #f6f8fb;
  --text: #111827;
  --muted: #6b7280;
  --card: #ffffff;
  --line: #e5e7eb;
  --brand: #5F0080; /* Finale 시그니처 퍼플 */
  --primary: #5F0080;
  --primary-text: #ffffff;
  --secondary-bg: #f3e5f5;
  --shadow: 0 1px 3px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06);
  --header-height: 54px;
  --nav-height: 60px;
}

@media (prefers-color-scheme: dark) {
  :root {
    --bg: #0f1115;
    --text: #f3f4f6;
    --muted: #9ca3af;
    --card: #151821;
    --line: #222738;
    --brand: #ab47bc;
    --primary: #ab47bc;
    --secondary-bg: #2c1b30;
    --shadow: none;
  }
}

/* === 2. 기본 리셋 및 레이아웃 === */
* { box-sizing: border-box; }
html, body { margin: 0; padding: 0; background: var(--bg); color: var(--text); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; -webkit-tap-highlight-color: transparent; }
a { color: inherit; text-decoration: none; }
button, input, textarea, select { font-family: inherit; }

.container { max-width: 480px; margin: 0 auto; min-height: 100vh; background: var(--bg); position: relative; padding-bottom: calc(var(--nav-height) + 20px); }

/* === 3. SPA 화면 전환 (CSS Target 방식) === */
section.screen { display: none; padding: 16px; animation: fadeIn 0.3s ease; }
section.screen:target { display: block; }
/* #home이 기본값처럼 보이게 하려면 JS로 처리하거나 구조상 배치가 중요하지만, 여기서는 JS로 초기 로드 처리 */

@keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
@keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

/* === 4. 공통 UI 컴포넌트 === */
.appbar { position: sticky; top: 0; z-index: 100; display: flex; align-items: center; gap: 8px; padding: 0 16px; height: var(--header-height); background: var(--card); border-bottom: 1px solid var(--line); }
.appbar .brand { display: flex; align-items: center; gap: 8px; font-weight: 800; font-size: 18px; color: var(--brand); }
.appbar .logo { display: inline-grid; place-items: center; width: 24px; height: 24px; border-radius: 6px; background: var(--brand); color: white; font-size: 14px; }
.appbar .icon-btn { border: none; background: transparent; padding: 8px; font-size: 20px; cursor: pointer; border-radius: 50%; color: var(--text); }

.tabbar { position: fixed; bottom: 0; left: 0; right: 0; margin: 0 auto; max-width: 480px; height: var(--nav-height); background: var(--card); border-top: 1px solid var(--line); display: grid; grid-template-columns: repeat(5, 1fr); z-index: 100; }
.tab { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; font-size: 10px; color: var(--muted); }
.tab.active { color: var(--brand); font-weight: bold; }
.tab .ic { font-size: 20px; }

.card { background: var(--card); border: 1px solid var(--line); border-radius: 16px; padding: 20px; margin-bottom: 16px; box-shadow: var(--shadow); }
.btn { border: 1px solid var(--line); background: var(--card); border-radius: 12px; padding: 12px 16px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; gap: 6px; transition: 0.2s; }
.btn.primary { background: var(--primary); border-color: var(--primary); color: var(--primary-text); }
.btn.ghost { background: transparent; border: none; color: var(--muted); }
.btn.small { padding: 8px 12px; font-size: 13px; border-radius: 8px; }
.btn.full { width: 100%; }

.input-group { margin-bottom: 16px; }
.input { width: 100%; padding: 12px; border: 1px solid var(--line); border-radius: 10px; font-size: 15px; background: var(--card); color: var(--text); outline: none; }
.input:focus { border-color: var(--brand); }

/* 유틸리티 */
.vstack { display: flex; flex-direction: column; }
.hstack { display: flex; align-items: center; }
.gap-10 { gap: 10px; } .gap-20 { gap: 20px; }
.space-between { justify-content: space-between; }
.bold { font-weight: 700; }
.text-sm { font-size: 14px; } .text-xs { font-size: 12px; }
.muted { color: var(--muted); }
.mt-10 { margin-top: 10px; } .mb-10 { margin-bottom: 10px; }
.grow { flex: 1; }
.text-right { text-align: right; } .text-center { text-align: center; }
.text-red { color: #d32f2f; } .text-blue { color: #1976d2; }

/* === 5. 특수 기능 UI (복원됨) === */

/* [사이드 메뉴] */
#sideMenu { position: fixed; top: 0; left: -280px; width: 280px; height: 100%; background: var(--card); z-index: 2000; transition: left 0.3s ease; box-shadow: 2px 0 10px rgba(0,0,0,0.1); overflow-y: auto; }
#sideMenu.active { left: 0; }
#menuOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1999; display: none; }
#menuOverlay.active { display: block; }
.menu-header { padding: 24px; background: var(--bg); border-bottom: 1px solid var(--line); }
.menu-list { list-style: none; padding: 0; margin: 0; }
.menu-list li { border-bottom: 1px solid var(--line); }
.menu-list a { display: block; padding: 16px 24px; color: var(--text); font-weight: 500; }

/* [체크리스트 탭] */
.check-tab-container { overflow-x: auto; white-space: nowrap; padding-bottom: 10px; -ms-overflow-style: none; scrollbar-width: none; }
.check-tab-container::-webkit-scrollbar { display: none; }
.check-tab-btn { background: var(--card); border: 1px solid var(--line); padding: 8px 16px; border-radius: 20px; font-size: 13px; color: var(--muted); cursor: pointer; margin-right: 6px; }
.check-tab-btn.active { background: var(--brand); color: white; border-color: var(--brand); }
.check-content { display: none; animation: fadeIn 0.3s ease; }
.check-content.active { display: block; }
.check-item { display: flex; align-items: flex-start; padding: 12px 0; border-bottom: 1px solid var(--line); }
.check-item input[type="checkbox"] { margin-right: 12px; margin-top: 4px; accent-color: var(--brand); transform: scale(1.1); }

/* [문서 양식 스타일 - 정부문서 느낌] */
.doc-paper { background: white; border: 1px solid var(--line); padding: 20px; box-shadow: 2px 2px 5px rgba(0,0,0,0.05); font-family: "Batang", serif; position: relative; color: #333; margin-bottom: 16px; }
.doc-header { text-align: center; border-bottom: 2px double #333; margin-bottom: 15px; padding-bottom: 10px; }
.doc-title { font-size: 18px; font-weight: bold; letter-spacing: 2px; color: #000; }
.doc-table { width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 15px; }
.doc-table th { background: #f7f7f7; border: 1px solid #888; padding: 6px; text-align: center; font-weight: bold; color: #333; }
.doc-table td { border: 1px solid #888; padding: 6px; color: #333; }
.stamp-box { position: absolute; bottom: 20px; right: 20px; width: 50px; height: 50px; border: 3px solid #d32f2f; border-radius: 50%; color: #d32f2f; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 12px; transform: rotate(-15deg); opacity: 0.8; pointer-events: none; }
.highlight-bg { background: #fffde7; }

/* [채팅창] */
.chat-screen { background-color: #b2c7da; min-height: 100vh; display: flex; flex-direction: column; padding: 0 !important; }
.chat-area { flex: 1; padding: 16px; overflow-y: auto; padding-bottom: 80px; }
.chat-date { text-align: center; font-size: 10px; color: #fff; background: rgba(0,0,0,0.1); padding: 3px 10px; border-radius: 10px; margin: 10px auto; width: fit-content; }
.chat-bubble-row { display: flex; margin-bottom: 10px; }
.chat-bubble-row.me { justify-content: flex-end; }
.chat-bubble { max-width: 70%; padding: 10px; border-radius: 10px; font-size: 14px; position: relative; box-shadow: 0 1px 2px rgba(0,0,0,0.1); line-height: 1.4; }
.chat-bubble.you { background: white; color: #333; border-top-left-radius: 0; }
.chat-bubble.me { background: var(--brand); color: white; border-top-right-radius: 0; }
.chat-profile { width: 35px; height: 35px; background: #fff; border-radius: 50%; margin-right: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
.chat-input-bar { position: fixed; bottom: 0; left: 0; width: 100%; max-width: 480px; margin: 0 auto; background: white; padding: 10px; display: flex; align-items: center; box-shadow: 0 -2px 5px rgba(0,0,0,0.05); }

/* [글쓰기 모달] */
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 3000; display: none; align-items: center; justify-content: center; }
.modal-overlay.active { display: flex; }
.write-card { background: var(--card); width: 90%; max-width: 400px; border-radius: 16px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); animation: slideUp 0.3s ease; }
textarea.input { resize: none; height: 100px; }

/* 리스트 및 태그 */
.tag { font-size: 11px; color: var(--brand); background: var(--secondary-bg); padding: 2px 6px; border-radius: 4px; }
.status-done { background: #e8f5e9; color: #2e7d32; font-size: 11px; padding: 2px 6px; border-radius: 4px; }
.status-wait { background: #f5f5f5; color: #757575; font-size: 11px; padding: 2px 6px; border-radius: 4px; }
.badge { background: #e74c3c; color: white; font-size: 10px; padding: 2px 5px; border-radius: 4px; margin-left: 5px; }

<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Finale | ìƒì†Â·ì„¸ë¬´ ëª¨ë°”ì¼ ë°ëª¨</title>
  <style>
    /* === 1. ë””ìì¸ ì‹œìŠ¤í…œ (íŒŒë€ìƒ‰ í…Œë§ˆ) === */
    :root {
      --bg: #f0f2f5;
      --text: #111827;
      --muted: #6b7280;
      --card: #ffffff;
      --line: #dae1e7;

      --brand: #1e3a8a;
      --primary: #2563eb;
      --primary-text: #ffffff;
      --secondary-bg: #eff6ff;

      --shadow: 0 2px 8px rgba(0,0,0,0.08);
      --nav-height: 60px;
    }

    /* === 2. ê¸°ë³¸ ì„¤ì • === */
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; background: var(--bg); color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      -webkit-tap-highlight-color: transparent;
    }
    a { text-decoration: none; color: inherit; }
    button, input, textarea, select { font-family: inherit; }

    /* í™”ë©´ ì „í™˜ */
    .container { max-width: 480px; margin: 0 auto; min-height: 100vh; background: var(--bg); position: relative; padding-bottom: 80px; }
    section.screen { display: none; padding: 16px; animation: fadeIn 0.25s ease; }
    section.screen:target { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

    /* === 3. í•µì‹¬ ë ˆì´ì•„ì›ƒ === */
    .card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 12px;
      box-shadow: var(--shadow);
    }

    .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin: 12px 0; }
    .shortcut {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      gap: 6px; border: 1px solid var(--line); border-radius: 12px; padding: 12px 4px;
      background: var(--card); font-size: 12px; color: var(--text);
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    .shortcut .ic { font-size: 24px; margin-bottom: 2px; }

    .select-card {
      display: flex; align-items: center; gap: 16px;
      background: var(--card); border: 1px solid var(--line);
      border-radius: 16px; padding: 20px; margin-bottom: 12px; box-shadow: var(--shadow);
    }
    .select-card .ic { font-size: 32px; }
    .select-title { font-weight: 800; font-size: 16px; margin-bottom: 4px; }
    .select-desc { font-size: 13px; color: var(--muted); }

    .list-elev { list-style: none; padding: 0; margin: 0; }
    .list-elev .list-item {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 16px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    .list-title { font-weight: 700; margin-bottom: 4px; font-size: 15px; }
    .list-desc { font-size: 12px; color: var(--muted); }

    /* === 4. UI êµ¬ì„±ìš”ì†Œ === */
    .appbar { position: sticky; top: 0; z-index: 100; display: flex; align-items: center; gap: 10px; padding: 0 16px; height: 54px; background: var(--card); border-bottom: 1px solid var(--line); }
    .appbar .brand { display: flex; align-items: center; gap: 8px; font-weight: 800; font-size: 18px; color: var(--brand); }
    .appbar .logo { display: inline-grid; place-items: center; width: 24px; height: 24px; border-radius: 6px; background: var(--brand); color: white; font-size: 14px; }
    .icon-btn { border: none; background: transparent; padding: 8px; font-size: 20px; cursor: pointer; }

    .tabbar { position: fixed; bottom: 0; left: 0; right: 0; margin: 0 auto; max-width: 480px; height: 60px; background: var(--card); border-top: 1px solid var(--line); display: grid; grid-template-columns: repeat(5, 1fr); z-index: 100; }
    .tab { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; font-size: 10px; color: var(--muted); }
    .tab.active { color: var(--brand); font-weight: 800; }
    .tab .ic { font-size: 20px; }

    .btn { border: 1px solid var(--line); background: var(--card); border-radius: 10px; padding: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 6px; font-size: 14px; }
    .btn.primary { background: var(--brand); border-color: var(--brand); color: white; }
    .btn.ghost { background: transparent; border: none; color: var(--muted); }
    .btn.small { padding: 8px 12px; font-size: 12px; border-radius: 8px; }
    .btn.full { width: 100%; }

    .input { width: 100%; padding: 12px; border: 1px solid var(--line); border-radius: 10px; font-size: 15px; background: #f9fafb; outline: none; margin-bottom: 10px; }
    .input:focus { border-color: var(--brand); background: white; }

    /* ìœ í‹¸ */
    .hstack { display: flex; align-items: center; }
    .vstack { display: flex; flex-direction: column; }
    .space-between { justify-content: space-between; }
    .gap-10 { gap: 10px; } .gap-4 { gap: 4px; }
    .bold { font-weight: 700; }
    .text-sm { font-size: 14px; } .tiny { font-size: 11px; }
    .muted { color: var(--muted); }
    .mt-10 { margin-top: 10px; } .mt-6 { margin-top: 6px; } .mb-10 { margin-bottom: 10px; }
    .grow { flex: 1; }
    .center { text-align: center; } .right { text-align: right; }

    .chip { border: 1px solid var(--line); background: white; border-radius: 20px; padding: 6px 12px; font-size: 12px; }
    .badge-new { background: #ef4444; color: white; font-size: 10px; padding: 2px 6px; border-radius: 4px; margin-left: 4px; }

    /* ìƒíƒœ ë±ƒì§€ (ëˆ„ë½ë˜ì–´ ìˆì–´ì„œ ì¶”ê°€) */
    .status-done, .status-wait {
      font-size: 11px; padding: 4px 8px; border-radius: 8px; border: 1px solid var(--line);
      white-space: nowrap;
    }
    .status-done { background: #e7f7ed; border-color: #bfe8cd; color: #166534; }
    .status-wait { background: #f3f4f6; color: #374151; }

    /* === 5. íŠ¹ìˆ˜ ê¸°ëŠ¥ === */
    .doc-paper { background: white; border: 1px solid var(--line); padding: 20px; box-shadow: 2px 2px 5px rgba(0,0,0,0.05); font-family: "Batang", serif; position: relative; color: #333; margin-bottom: 16px; }
    .doc-header { text-align: center; border-bottom: 2px double #333; margin-bottom: 15px; padding-bottom: 10px; }
    .doc-title { font-size: 18px; font-weight: bold; letter-spacing: 2px; }
    .doc-table { width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 15px; }
    .doc-table th { background: #f3f4f6; border: 1px solid #999; padding: 6px; text-align: center; font-weight: bold; }
    .doc-table td { border: 1px solid #999; padding: 6px; }
    .stamp-box { position: absolute; bottom: 20px; right: 20px; width: 50px; height: 50px; border: 3px solid #ef4444; border-radius: 50%; color: #ef4444; display: flex; align-items: center; justify-content: center; font-weight: bold; transform: rotate(-15deg); opacity: 0.85; }
    .highlight-bg { background: #fef9c3; }

    /* ì²´í¬ë¦¬ìŠ¤íŠ¸ */
    .check-tab-container { overflow-x: auto; white-space: nowrap; padding-bottom: 8px; }
    .check-tab-btn { background: white; border: 1px solid var(--line); padding: 8px 16px; border-radius: 20px; font-size: 13px; color: var(--muted); cursor: pointer; margin-right: 6px; }
    .check-tab-btn.active { background: var(--brand); color: white; border-color: var(--brand); font-weight: 800; }
    .check-content { display: none; animation: fadeIn 0.2s; }
    .check-content.active { display: block; }
    .check-item { display: flex; align-items: flex-start; padding: 12px 0; border-bottom: 1px solid var(--line); cursor: pointer; }
    .check-item input { margin-right: 12px; margin-top: 4px; accent-color: var(--brand); transform: scale(1.2); }

    /* ê³„ì‚° ê²°ê³¼ ë°•ìŠ¤(show í´ë˜ìŠ¤ ëˆ„ë½ë˜ì–´ ìˆì–´ì„œ ì¶”ê°€) */
    .calc-result-box { background: var(--secondary-bg); border: 1px solid #c7ddff; padding: 16px; border-radius: 14px; margin-top: 14px; display: none; }
    .calc-result-box.show { display: block; }

    /* ì±„íŒ… */
    .chat-screen { background-color: #dbeafe; padding: 0 !important; display: flex; flex-direction: column; height: 100vh; }
    .chat-area { flex: 1; padding: 16px; overflow-y: auto; padding-bottom: 80px; }
    .chat-date { text-align: center; font-size: 11px; background: rgba(0,0,0,0.1); color: white; padding: 4px 12px; border-radius: 12px; margin: 10px auto; width: fit-content; }
    .chat-bubble-row { display: flex; margin-bottom: 10px; gap: 8px; }
    .chat-bubble-row.me { justify-content: flex-end; }
    .chat-bubble { max-width: 75%; padding: 10px 14px; border-radius: 12px; font-size: 14px; line-height: 1.4; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
    .chat-bubble.you { background: white; color: #333; border-top-left-radius: 0; }
    .chat-bubble.me { background: var(--brand); color: white; border-top-right-radius: 0; }
    .chat-profile { width: 36px; height: 36px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; border: 1px solid #eee; flex: 0 0 auto; }
    .chat-name { margin-bottom: 4px; }

    .chat-input-bar { position: fixed; bottom: 0; left: 0; right: 0; max-width: 480px; margin: 0 auto; background: white; padding: 10px; display: flex; align-items: center; gap: 10px; border-top: 1px solid var(--line); }
    .chat-send-btn {
      width: 42px; height: 42px; border-radius: 50%;
      border: none; background: var(--brand); color: white;
      display: inline-grid; place-items: center;
      font-size: 16px; cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.12);
    }

    /* ì‚¬ì´ë“œë©”ë‰´ & ëª¨ë‹¬ */
    #menuOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1999; display: none; }
    #menuOverlay.active { display: block; }
    #sideMenu { position: fixed; top: 0; left: -280px; width: 280px; height: 100%; background: white; z-index: 2000; transition: left 0.3s; box-shadow: 2px 0 10px rgba(0,0,0,0.1); overflow-y: auto; }
    #sideMenu.active { left: 0; }
    .menu-list a { display: block; padding: 16px 20px; border-bottom: 1px solid #f3f4f6; color: var(--text); }

    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 3000; display: none; align-items: center; justify-content: center; }
    .modal-overlay.active { display: flex; }
    .write-card { background: white; width: 90%; max-width: 400px; border-radius: 16px; padding: 20px; animation: fadeIn 0.2s; }

    /* ì‘ì€ ê°œì„ : ì œëª© ìŠ¤íƒ€ì¼ (ì›ë³¸ì— title-sm í´ë˜ìŠ¤ëŠ” ì—†ì–´ì„œ ì¶”ê°€) */
    .title-sm { font-size: 16px; font-weight: 800; margin: 0; }

  </style>
</head>
<body>

  <div id="menuOverlay" onclick="toggleMenu(false)"></div>

  <aside id="sideMenu" aria-label="ì‚¬ì´ë“œ ë©”ë‰´">
      <div style="padding:24px; background:#f9fafb; border-bottom:1px solid #eee;">
          <div class="hstack space-between">
            <h3 style="margin:0; font-size:16px;">ê¹€â—‹â—‹ë‹˜, ì•ˆë…•í•˜ì„¸ìš”</h3>
            <button onclick="toggleMenu(false)" class="btn ghost" style="font-size:20px;">âœ•</button>
          </div>
          <p class="tiny muted mt-6">finale@example.com</p>
          <button class="btn primary small full mt-10" onclick="alert('ë°ëª¨: ë¡œê·¸ì•„ì›ƒ')">ë¡œê·¸ì•„ì›ƒ</button>
      </div>
      <ul class="menu-list" style="list-style:none; padding:0; margin:0;">
          <li><a href="#" onclick="alert('ë°ëª¨: ë‚´ ì„œë¥˜ ë³´ê´€í•¨')">ğŸ“‚ ë‚´ ì„œë¥˜ ë³´ê´€í•¨ <span class="badge-new">NEW</span></a></li>
          <li><a href="#doc-checklist" onclick="toggleMenu(false)">ğŸ“‹ í•„ìš” ì„œë¥˜ ì²´í¬ë¦¬ìŠ¤íŠ¸</a></li>
          <li><a href="#qna-list" onclick="toggleMenu(false)">ğŸ—£ï¸ ìƒì† ì»¤ë®¤ë‹ˆí‹°</a></li>
          <li><a href="#guide-detail" onclick="toggleMenu(false)">â“ ì´ìš© ê°€ì´ë“œ</a></li>
          <li><a href="#" onclick="alert('ë°ëª¨: í™˜ê²½ì„¤ì •')">âš™ï¸ í™˜ê²½ì„¤ì •</a></li>
      </ul>
  </aside>

  <!-- ëª¨ë‹¬: ë°°ê²½ í´ë¦­ ì‹œ ë‹«íˆë„ë¡ ìˆ˜ì • -->
  <div id="writeModal" class="modal-overlay" onclick="closeQnaWrite()">
      <div class="write-card" onclick="event.stopPropagation()">
          <div class="hstack space-between mb-10">
              <h3 style="margin:0;">ì§ˆë¬¸í•˜ê¸°</h3>
              <button onclick="closeQnaWrite()" class="btn ghost" style="font-size:20px;">âœ•</button>
          </div>
          <label class="tiny bold muted">ì¹´í…Œê³ ë¦¬</label>
          <select id="qna-category" class="input">
              <option value="#ìƒì†ì„¸">ìƒì†ì„¸/ì¦ì—¬ì„¸</option>
              <option value="#ë“±ê¸°">ë¶€ë™ì‚°/ë“±ê¸°</option>
              <option value="#ë¶€ì±„">ë¹š ìƒì†</option>
          </select>
          <label class="tiny bold muted">ì œëª©</label>
          <input type="text" id="qna-title" class="input" placeholder="ê¶ê¸ˆí•œ ë‚´ìš©ì„ í•œ ì¤„ë¡œ ìš”ì•½">
          <label class="tiny bold muted">ë‚´ìš©</label>
          <textarea id="qna-content" class="input" style="height:100px; resize:none;" placeholder="ìƒí™©ì„ ìì„¸íˆ ì ì–´ì£¼ì„¸ìš”"></textarea>
          <button class="btn primary full" onclick="submitQuestion()">ë“±ë¡í•˜ê¸°</button>
      </div>
  </div>

  <header class="appbar" aria-label="ìƒë‹¨ ë°”">
    <button class="icon-btn" onclick="toggleMenu(true)">â˜°</button>
    <div class="brand"><span class="logo">F</span> Finale</div>
    <div class="grow"></div>
    <button class="icon-btn" onclick="alert('ë°ëª¨: ê²€ìƒ‰')">ğŸ”</button>
    <button class="icon-btn" onclick="alert('ë°ëª¨: ì•Œë¦¼')">ğŸ””</button>
  </header>

  <main class="container">

    <section class="screen" id="login">
      <div class="center" style="margin-top:60px; margin-bottom:40px;">
        <div class="brand" style="justify-content:center; font-size:40px; margin-bottom:10px;">
            <span class="logo" style="width:40px; height:40px; font-size:24px;">F</span> Finale
        </div>
        <p class="muted">ë³µì¡í•œ ìƒì†, ì´ì œëŠ” ì‰½ê³  ê°„í¸í•˜ê²Œ</p>
      </div>
      <div class="card">
        <form onsubmit="location.hash='#home'; return false;" class="vstack gap-10" autocomplete="off">
          <input type="email" class="input" placeholder="ì•„ì´ë””(ì´ë©”ì¼)" required style="margin:0;">
          <input type="password" class="input" placeholder="ë¹„ë°€ë²ˆí˜¸" required style="margin:0;">
          <button class="btn primary full" type="submit">ë¡œê·¸ì¸</button>
        </form>
        <div class="center tiny muted mt-10 mb-10">ë˜ëŠ”</div>
        <div class="hstack gap-10 center" style="justify-content:center;">
          <button class="chip" type="button" onclick="alert('ë°ëª¨: Kakao ë¡œê·¸ì¸')">Kakao</button>
          <button class="chip" type="button" onclick="alert('ë°ëª¨: Naver ë¡œê·¸ì¸')">Naver</button>
          <button class="chip" type="button" onclick="alert('ë°ëª¨: Google ë¡œê·¸ì¸')">Google</button>
        </div>
      </div>
    </section>

    <section class="screen" id="home">
      <div class="card">
        <div class="hstack space-between">
          <div>
            <div class="muted tiny">ê¹€â—‹â—‹ë‹˜ ìƒì†,</div>
            <div class="bold text-sm">3ë‹¨ê³„ ì§„í–‰ ì¤‘</div>
          </div>
          <button class="btn ghost small" type="button" onclick="alert('ë°ëª¨: ì„¸ë¶€ ì •ë³´')">ì„¸ë¶€ ì •ë³´</button>
        </div>
        <button class="btn primary full mt-10" type="button" onclick="location.hash='#choose'">ìƒˆ ìƒì† ì‹œì‘í•˜ê¸°</button>
        <div class="muted tiny mt-6 center">ì§€ê¸ˆ ì‹œì‘í•˜ì§€ ì•Šìœ¼ë©´ ì‹ ê³  ê¸°í•œì„ ë†“ì¹  ìˆ˜ ìˆì–´ìš”!</div>
      </div>

      <div class="grid-4">
        <a class="shortcut" href="#status"><span class="ic">ğŸ“Š</span><span>ì§„í–‰ í˜„í™©</span></a>
        <a class="shortcut" href="#assets"><span class="ic">ğŸ’¼</span><span>ë‚´ ìì‚°</span></a>
        <a class="shortcut" href="#experts"><span class="ic">ğŸ‘¥</span><span>ì „ë¬¸ê°€</span></a>
        <a class="shortcut" href="#mypage"><span class="ic">ğŸ‘¤</span><span>ë‚´ ì •ë³´</span></a>
      </div>

      <div class="card">
        <div class="bold mb-10">ê°„í¸ ìƒì† ê°€ì´ë“œ</div>
        <div class="hstack gap-10">
            <a href="#guide-detail" class="grow" style="background:var(--secondary-bg); padding:16px; border-radius:12px; text-align:center; border:1px solid #cfe3ff;">
                <div style="font-size:24px;">ğŸ“–</div><div class="bold tiny mt-6">ì´ˆë³´ì ê°€ì´ë“œ</div>
            </a>
            <a href="#doc-checklist" class="grow" style="background:var(--secondary-bg); padding:16px; border-radius:12px; text-align:center; border:1px solid #cfe3ff;">
                <div style="font-size:24px;">âœ…</div><div class="bold tiny mt-6">í•„ìš” ì„œë¥˜</div>
            </a>
        </div>
      </div>

      <div class="card" role="button" tabindex="0" onclick="location.hash='#qna-list'">
          <div class="hstack space-between">
              <span class="bold">ì „ë¬¸ê°€ Q&A</span>
              <span class="tiny muted">ë”ë³´ê¸° ></span>
          </div>
          <p class="tiny muted mt-6">"ìƒì† ì°©ìˆ˜, ì–´ë””ì„œë¶€í„° ì‹œì‘í•´ì•¼ í• ê¹Œìš”?"</p>
      </div>
    </section>

    <section class="screen" id="choose">
      <div class="vstack gap-10">
        <a class="select-card" href="#legal">
          <div class="ic">âš–ï¸</div>
          <div><div class="select-title">ë²•ë¬´ ì„œë¹„ìŠ¤</div><div class="select-desc">ìƒì† í™•ì¸, ë“±ê¸°, ìœ ë¥˜ë¶„ ë“±</div></div>
        </a>
        <a class="select-card" href="#tax">
          <div class="ic">ğŸ§¾</div>
          <div><div class="select-title">ì„¸ë¬´ ì„œë¹„ìŠ¤</div><div class="select-desc">ìƒì†ì„¸ ê³„ì‚°, ì‹ ê³ , ì¦ì—¬</div></div>
        </a>
      </div>
    </section>

    <section class="screen" id="legal">
      <div class="hstack gap-10 mb-10">
        <button onclick="history.back()" class="btn ghost" type="button">â†</button>
        <h3 class="title-sm">ë²•ë¬´ ì„œë¹„ìŠ¤</h3>
      </div>
      <ul class="list-elev">
        <li class="list-item"><div><div class="list-title">ìƒì† ì¬ì‚° ì¡°íšŒ</div><div class="list-desc">ì‚¬ë§ì ì¬ì‚° í˜„í™© íŒŒì•…</div></div><a href="#legal-property-sample" class="btn primary small">ì‹œì‘</a></li>
        <li class="list-item"><div><div class="list-title">ìƒì†ì¸ í™•ì¸</div><div class="list-desc">ìƒì† ìˆœìœ„ ë° ì„œë¥˜ ì•ˆë‚´</div></div><a href="#legal-heir-sample" class="btn primary small">ì‹œì‘</a></li>
        <li class="list-item"><div><div class="list-title">ìƒì† ë“±ê¸°</div><div class="list-desc">ë¶€ë™ì‚° ë“±ê¸° ì ˆì°¨ ì§„í–‰</div></div><a href="#legal-reg-sample" class="btn primary small">ì‹œì‘</a></li>
        <li class="list-item"><div><div class="list-title">ì „ë¬¸ê°€ ìƒë‹´</div><div class="list-desc">ë²•ì  ìë¬¸ ë° ë¶„ìŸ í•´ê²°</div></div><a href="#experts" class="btn ghost small">ì—°ê²°</a></li>
      </ul>
    </section>

    <section class="screen" id="tax">
      <div class="hstack gap-10 mb-10">
        <button onclick="history.back()" class="btn ghost" type="button">â†</button>
        <h3 class="title-sm">ì„¸ë¬´ ì„œë¹„ìŠ¤</h3>
      </div>
      <ul class="list-elev">
        <li class="list-item"><div><div class="list-title">ìƒì†ì„¸ ê³„ì‚°ê¸°</div><div class="list-desc">ì˜ˆìƒ ì„¸ê¸ˆ ê°„í¸ ê³„ì‚°</div></div><a href="#tax-calc" class="btn primary small">ê³„ì‚°</a></li>
        <li class="list-item"><div><div class="list-title">ì‹ ê³ ì„œ ë¯¸ë¦¬ë³´ê¸°</div><div class="list-desc">êµ­ì„¸ì²­ ë²•ì • ì„œì‹ ì‘ì„±</div></div><a href="#tax-return-sample" class="btn primary small">ë³´ê¸°</a></li>
        <li class="list-item"><div><div class="list-title">ì„¸ë¬´ì‚¬ ìƒë‹´</div><div class="list-desc">ì ˆì„¸ ì „ëµ ë° ì‹ ê³  ëŒ€í–‰</div></div><a href="#experts" class="btn ghost small">ì—°ê²°</a></li>
      </ul>
    </section>

    <section class="screen" id="tax-calc">
       <div class="hstack gap-10 mb-10">
         <button onclick="history.back()" class="btn ghost" type="button">â†</button>
         <h3 class="title-sm">ìƒì†ì„¸ ê³„ì‚°ê¸°</h3>
       </div>
       <div class="card">
           <label class="tiny bold muted">ì´ ìƒì† ìì‚° (ì›)</label>
           <input type="text" inputmode="numeric" id="calc-asset" class="input" placeholder="ì˜ˆ: 1,500,000,000" onkeyup="formatNumber(this)">

           <label class="tiny bold muted mt-10">ì´ ë¶€ì±„ ë° ì¥ë¡€ë¹„ìš© (ì›)</label>
           <input type="text" inputmode="numeric" id="calc-debt" class="input" placeholder="ì˜ˆ: 100,000,000" onkeyup="formatNumber(this)">

           <label class="tiny bold muted mt-10">ê³µì œ ê¸ˆì•¡ (ê¸°ë³¸ 10ì–µ ê°€ì •)</label>
           <input type="text" id="calc-deduction" class="input" value="1,000,000,000" readonly style="background:#eee;">

           <button class="btn primary full mt-10" type="button" onclick="calculateInheritanceTax()">ê³„ì‚°í•˜ê¸°</button>

           <div id="calc-result" class="calc-result-box" aria-live="polite">
               <div class="tiny muted">ì˜ˆìƒ ë‚©ë¶€ ìƒì†ì„¸</div>
               <div id="calc-tax-amount" style="font-size:24px; font-weight:800; color:var(--brand); margin:10px 0;">0ì›</div>
               <div class="tiny muted">ê³¼ì„¸í‘œì¤€: <span id="calc-base">0</span>ì› (ëˆ„ì§„ì„¸ìœ¨ ì ìš©)</div>
           </div>
       </div>
    </section>

    <section class="screen" id="tax-return-sample">
        <div class="hstack gap-10 mb-10">
          <button onclick="history.back()" class="btn ghost" type="button">â†</button>
          <h3 class="title-sm">ì‹ ê³ ì„œ ë¯¸ë¦¬ë³´ê¸°</h3>
        </div>
        <div class="doc-paper">
            <div class="doc-header"><div class="doc-title">ìƒì†ì„¸ ê³¼ì„¸í‘œì¤€ì‹ ê³ ì„œ</div></div>
            <table class="doc-table">
                <tr><th>êµ¬ë¶„</th><th>ê¸ˆì•¡ (ì›)</th></tr>
                <tr><td>â‘  ìƒì†ì¬ì‚°ê°€ì•¡</td><td class="right">1,250,000,000</td></tr>
                <tr><td>â‘¡ ê³µì œ/ë¹„ìš©</td><td class="right">- 1,105,000,000</td></tr>
                <tr class="highlight-bg"><td>â‘¢ ë‚©ë¶€í•  ì„¸ì•¡</td><td class="right bold" style="color:var(--brand);">18,430,000</td></tr>
            </table>
            <div class="center tiny mt-10">ã€Œìƒì†ì„¸ ë° ì¦ì—¬ì„¸ë²•ã€ì— ë”°ë¼ ì‹ ê³ í•©ë‹ˆë‹¤.</div>
            <div class="stamp-box">í™•ì¸</div>
        </div>
        <button class="btn primary full" type="button" onclick="alert('ë°ëª¨: ì„¸ë¬´ì‚¬ì—ê²Œ ì „ì†¡')">ì„¸ë¬´ì‚¬ì—ê²Œ ì „ì†¡</button>
    </section>

    <section class="screen" id="legal-property-sample">
        <div class="hstack gap-10 mb-10">
          <button onclick="history.back()" class="btn ghost" type="button">â†</button>
          <h3 class="title-sm">ì¬ì‚° ì¡°íšŒ ê²°ê³¼</h3>
        </div>
        <div class="doc-paper">
            <div class="doc-header"><div class="doc-title">ìƒì†ì¸ ê¸ˆìœµê±°ë˜ ì¡°íšŒ</div></div>
            <table class="doc-table">
                <tr><th>ê¸°ê´€ëª…</th><th>ìƒí’ˆ</th><th>ì”ì•¡</th></tr>
                <tr><td>ì‹ í•œì€í–‰</td><td>ì˜ˆê¸ˆ</td><td class="right">+5,000ë§Œ</td></tr>
                <tr><td>ìš°ë¦¬ì€í–‰</td><td>ëŒ€ì¶œ</td><td class="right">-1ì–µ</td></tr>
            </table>
            <div class="center bold mt-10">ê¸ˆìœµê°ë…ì›ì¥</div>
            <div class="stamp-box">ì¸</div>
        </div>
    </section>

    <!-- (ì´ì „ ë²„ì „ì— ìˆë˜ ìƒ˜í”Œ 2ê°œ ë¯¸ë¹„ë˜ì–´ ì¶”ê°€) -->
    <section class="screen" id="legal-heir-sample">
      <div class="hstack gap-10 mb-10">
        <button onclick="history.back()" class="btn ghost" type="button">â†</button>
        <h3 class="title-sm">ìƒì†ì¸ í™•ì¸</h3>
      </div>
      <div class="doc-paper">
        <div class="doc-header"><div class="doc-title">ê°€ì¡±ê´€ê³„ì¦ëª…ì„œ(ìƒì„¸)</div></div>
        <table class="doc-table">
          <tr><th>í”¼ìƒì†ì¸</th><td>ê¹€ì² ìˆ˜</td><th>ì¶œìƒ</th><td>1948.01.01</td></tr>
          <tr><th>ë°°ìš°ì</th><td>ì´ì˜í¬</td><th>ìë…€</th><td>ê¹€ì•„ë“¤, ê¹€ë”¸</td></tr>
        </table>
        <div class="center tiny muted">ë¯¼ë²• ì œ1000ì¡° ê¸°ì¤€ ë°ëª¨ í™”ë©´</div>
        <div class="stamp-box">ì¸</div>
      </div>
      <button class="btn primary full" type="button" onclick="alert('ë°ëª¨: ìƒì†ì§€ë¶„ í™•ì •')">ìƒì† ì§€ë¶„ í™•ì •</button>
    </section>

    <section class="screen" id="legal-reg-sample">
      <div class="hstack gap-10 mb-10">
        <button onclick="history.back()" class="btn ghost" type="button">â†</button>
        <h3 class="title-sm">ìƒì† ë“±ê¸°</h3>
      </div>
      <div class="doc-paper">
        <div class="doc-header"><div class="doc-title">ì†Œìœ ê¶Œì´ì „ë“±ê¸°ì‹ ì²­(ìƒì†)</div></div>
        <table class="doc-table">
          <tr><th>ë¶€ë™ì‚°</th><td>ì„œìš¸ ì„œì´ˆêµ¬ ë°˜í¬ë™ â€¦</td></tr>
          <tr><th>ë“±ê¸°ì›ì¸</th><td>2025.10.01 ìƒì†</td></tr>
          <tr><th>ì‹ ì²­ì¸</th><td>ì´ì˜í¬ ì™¸ 2ëª…</td></tr>
        </table>
        <div class="tiny muted">ì²¨ë¶€ì„œë¥˜: í† ì§€/ê±´ì¶•ë¬¼ëŒ€ì¥, í˜‘ì˜ì„œ, ì·¨ë“ì„¸ ë‚©ë¶€í™•ì¸ ë“±</div>
        <div class="stamp-box">ì¸</div>
      </div>
      <button class="btn primary full" type="button" onclick="alert('ë°ëª¨: ë“±ê¸° ì „ë¬¸ê°€ì—ê²Œ ì „ì†¡')">ë“±ê¸° ì „ë¬¸ê°€ì—ê²Œ ì „ì†¡</button>
    </section>

    <section class="screen" id="doc-checklist">
        <div class="hstack gap-10 mb-10">
          <button onclick="history.back()" class="btn ghost" type="button">â†</button>
          <h3 class="title-sm">í•„ìš” ì„œë¥˜</h3>
        </div>

        <div class="check-tab-container" role="tablist" aria-label="ì²´í¬ë¦¬ìŠ¤íŠ¸ íƒ­">
             <!-- âœ… event ë²„ê·¸ ìˆ˜ì •: eventë¥¼ ë„˜ê¸°ë„ë¡ ë³€ê²½ -->
             <button class="check-tab-btn active" onclick="showTab(event,'common')" role="tab" aria-selected="true">ê³µí†µ í•„ìˆ˜</button>
             <button class="check-tab-btn" onclick="showTab(event,'estate')" role="tab" aria-selected="false">ë¶€ë™ì‚° ë“±ê¸°</button>
             <button class="check-tab-btn" onclick="showTab(event,'bank')" role="tab" aria-selected="false">ê¸ˆìœµ/ì˜ˆê¸ˆ</button>
             <button class="check-tab-btn" onclick="showTab(event,'giveup')" role="tab" aria-selected="false">ìƒì† í¬ê¸°</button>
        </div>

        <div class="card mt-10" style="min-height:300px;">
            <div id="tab-common" class="check-content active">
                <div class="check-item"><label class="hstack grow"><input type="checkbox"><div><div class="bold text-sm">ê¸°ë³¸ì¦ëª…ì„œ (ìƒì„¸)</div><div class="tiny muted">ì£¼ë¯¼ë²ˆí˜¸ ì „ë¶€ ê³µê°œ</div></div></label></div>
                <div class="check-item"><label class="hstack grow"><input type="checkbox"><div><div class="bold text-sm">ê°€ì¡±ê´€ê³„ì¦ëª…ì„œ</div></div></label></div>
                <div class="check-item"><label class="hstack grow"><input type="checkbox"><div><div class="bold text-sm">ì¸ê°ì¦ëª…ì„œ (ì „ì›)</div></div></label></div>
            </div>
            <div id="tab-estate" class="check-content">
                <div class="check-item"><label class="hstack grow"><input type="checkbox"><div><div class="bold text-sm">í† ì§€/ê±´ì¶•ë¬¼ ëŒ€ì¥</div></div></label></div>
                <div class="check-item"><label class="hstack grow"><input type="checkbox"><div><div class="bold text-sm">ì·¨ë“ì„¸ ë‚©ë¶€í™•ì¸ì„œ</div></div></label></div>
            </div>
            <div id="tab-bank" class="check-content">
                <div class="check-item"><label class="hstack grow"><input type="checkbox"><div><div class="bold text-sm">ê¸ˆìœµê±°ë˜ì¡°íšŒ ì‹ ì²­ì„œ</div></div></label></div>
            </div>
            <div id="tab-giveup" class="check-content">
                <div class="check-item"><label class="hstack grow"><input type="checkbox"><div><div class="bold text-sm">ì‹¬íŒì²­êµ¬ì„œ</div></div></label></div>
                <div class="check-item"><label class="hstack grow"><input type="checkbox"><div><div class="bold text-sm">ë¶€ì±„ì¦ëª…ì„œ</div></div></label></div>
            </div>

            <button class="btn primary full mt-10" type="button" onclick="alert('ë°ëª¨: ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!')">ì €ì¥í•˜ê¸°</button>
        </div>
    </section>

    <section class="screen" id="experts">
        <div class="card" style="background:var(--secondary-bg); border:1px solid #cfe3ff;">
          <h3 class="bold text-sm" style="margin:0;">ìƒì† ì „ë¬¸ íŒŒíŠ¸ë„ˆ ì¶”ì²œ</h3>
          <p class="tiny muted mt-6" style="margin:0;">ìƒí™©ì— ë§ëŠ” ë³€í˜¸ì‚¬Â·ì„¸ë¬´ì‚¬ë¥¼ ì—°ê²°í•´ë“œë ¤ìš”.</p>
        </div>

        <div class="vstack gap-10">
            <div class="card">
                <div class="hstack gap-10">
                    <div class="chat-profile">ğŸ‘¨â€âš–ï¸</div>
                    <div><div class="bold">ê¹€ë²•ë¬´ ë³€í˜¸ì‚¬</div><div class="tiny muted">ìƒì†ë“±ê¸° ì „ë¬¸</div></div>
                </div>
                <div class="hstack gap-10 mt-10">
                    <button class="btn ghost small grow" type="button" onclick="alert('ë°ëª¨: í”„ë¡œí•„')">í”„ë¡œí•„</button>
                    <button class="btn primary small grow" type="button" onclick="location.hash='#chat-lawyer'">ìƒë‹´ ì‹ ì²­</button>
                </div>
            </div>
            <div class="card">
                <div class="hstack gap-10">
                    <div class="chat-profile">ğŸ‘©â€ğŸ’¼</div>
                    <div><div class="bold">ì´ì„¸ë¬´ ì„¸ë¬´ì‚¬</div><div class="tiny muted">ìƒì†ì„¸ ì ˆì„¸</div></div>
                </div>
                <div class="hstack gap-10 mt-10">
                    <button class="btn ghost small grow" type="button" onclick="alert('ë°ëª¨: í”„ë¡œí•„')">í”„ë¡œí•„</button>
                    <button class="btn primary small grow" type="button" onclick="location.hash='#chat-tax'">ìƒë‹´ ì‹ ì²­</button>
                </div>
            </div>
        </div>
    </section>

    <section class="screen chat-screen" id="chat-lawyer">
        <div class="appbar" style="background:white; border-bottom:1px solid var(--line); position: sticky; top: 0;">
            <button onclick="history.back()" class="icon-btn" type="button">â†</button>
            <div class="bold">ê¹€ë²•ë¬´ ë³€í˜¸ì‚¬</div>
        </div>

        <div class="chat-area" id="msg-area-lawyer" aria-label="ì±„íŒ… ì˜ì—­">
            <div class="chat-date">2025ë…„ 10ì›” 12ì¼</div>
            <div class="chat-bubble-row you">
              <div class="chat-profile">ğŸ‘¨â€âš–ï¸</div>
              <div>
                <div class="chat-name tiny muted">ê¹€ë²•ë¬´</div>
                <div class="chat-bubble you">ì•ˆë…•í•˜ì„¸ìš”. ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?</div>
              </div>
            </div>
        </div>

        <div class="chat-input-bar">
            <!-- âœ… Enter ì²˜ë¦¬ ê°œì„ : onkeydown + preventDefault -->
            <input type="text" class="input" id="input-lawyer" placeholder="ë©”ì‹œì§€ ì…ë ¥" style="margin:0; flex:1;"
                   onkeydown="handleEnter(event, 'lawyer')">
            <button class="chat-send-btn" type="button" onclick="sendMessage('lawyer')">â¤</button>
        </div>
    </section>

    <section class="screen chat-screen" id="chat-tax">
        <div class="appbar" style="background:white; border-bottom:1px solid var(--line); position: sticky; top: 0;">
            <button onclick="history.back()" class="icon-btn" type="button">â†</button>
            <div class="bold">ì´ì„¸ë¬´ ì„¸ë¬´ì‚¬</div>
        </div>

        <div class="chat-area" id="msg-area-tax" aria-label="ì±„íŒ… ì˜ì—­">
            <div class="chat-date">2025ë…„ 10ì›” 12ì¼</div>
            <div class="chat-bubble-row you">
              <div class="chat-profile">ğŸ‘©â€ğŸ’¼</div>
              <div>
                <div class="chat-name tiny muted">ì´ì„¸ë¬´</div>
                <div class="chat-bubble you">ë°˜ê°‘ìŠµë‹ˆë‹¤. ì„¸ë¬´ ìƒë‹´ì„ ì‹œì‘í•©ë‹ˆë‹¤.</div>
              </div>
            </div>
        </div>

        <div class="chat-input-bar">
            <input type="text" class="input" id="input-tax" placeholder="ë©”ì‹œì§€ ì…ë ¥" style="margin:0; flex:1;"
                   onkeydown="handleEnter(event, 'tax')">
            <button class="chat-send-btn" type="button" onclick="sendMessage('tax')">â¤</button>
        </div>
    </section>

    <section class="screen" id="qna-list">
        <div class="hstack space-between mb-10">
          <h3 class="title-sm">ì „ë¬¸ê°€ Q&A</h3>
          <button class="btn primary small" type="button" onclick="openQnaWrite()">ì§ˆë¬¸í•˜ê¸°</button>
        </div>

        <div class="vstack gap-10" id="qna-container">
            <div class="card">
                <div class="hstack space-between mb-10">
                  <span class="tiny bold" style="color:var(--brand);">#ìƒì†ì„¸</span>
                  <span class="status-done">ë‹µë³€ì™„ë£Œ</span>
                </div>
                <div class="bold">ë°°ìš°ì ê³µì œ í•œë„ ë¬¸ì˜</div>
                <div class="tiny muted mt-6">30ì–µê¹Œì§€ ê°€ëŠ¥í•œê°€ìš”?</div>
            </div>

            <div class="card">
                <div class="hstack space-between mb-10">
                  <span class="tiny bold" style="color:var(--brand);">#ë“±ê¸°</span>
                  <span class="status-wait">ë‹µë³€ëŒ€ê¸°</span>
                </div>
                <div class="bold">ë¯¸ë“±ê¸° ê±´ë¬¼ ìƒì†</div>
                <div class="tiny muted mt-6">ì‹œê³¨ì§‘ì´ ë¬´í—ˆê°€ì…ë‹ˆë‹¤.</div>
            </div>
        </div>
    </section>

    <section class="screen" id="guide-detail">
      <div class="hstack gap-10 mb-10">
        <button onclick="history.back()" class="btn ghost" type="button">â†</button>
        <h3 class="title-sm">ì´ìš© ê°€ì´ë“œ</h3>
      </div>
      <div class="card">
        <div class="bold">ì™œ Finaleì¸ê°€ìš”?</div>
        <p class="muted text-sm" style="margin-bottom:0;">
          ë³µì¡í•œ ìƒì† ì ˆì°¨ë¥¼ â€œì„œë¥˜ â†’ ì „ë¬¸ê°€ â†’ ì‹ ê³ /ë“±ê¸°â€ íë¦„ìœ¼ë¡œ ì •ë¦¬í•´, ì‚¬ìš©ìê°€ ê¸¸ì„ ìƒì§€ ì•Šê²Œ ë•ëŠ” ë°ëª¨ì…ë‹ˆë‹¤.
        </p>
      </div>
      <div class="card" style="background:var(--secondary-bg); border:1px solid #cfe3ff;">
        <div class="bold">ê¶Œì¥ íë¦„</div>
        <ol class="text-sm muted" style="margin:10px 0 0 18px;">
          <li>í•„ìš” ì„œë¥˜ ì²´í¬ë¦¬ìŠ¤íŠ¸ í™•ì¸</li>
          <li>ì¬ì‚°/ìƒì†ì¸ ìƒ˜í”Œ ë¬¸ì„œ í™•ì¸</li>
          <li>ì „ë¬¸ê°€ ì—°ê²° â†’ ì±„íŒ… ìƒë‹´</li>
          <li>ì„¸ë¬´ ì‹ ê³ ì„œ ë¯¸ë¦¬ë³´ê¸°</li>
        </ol>
      </div>
    </section>

    <section class="screen" id="status"><div class="card center">ì§„í–‰ í˜„í™© í˜ì´ì§€(ë°ëª¨)</div></section>
    <section class="screen" id="assets"><div class="card center">ë‚´ ìì‚° í˜ì´ì§€(ë°ëª¨)</div></section>
    <section class="screen" id="mypage"><div class="card center">ë§ˆì´ í˜ì´ì§€(ë°ëª¨)</div></section>

  </main>

  <nav class="tabbar" aria-label="í•˜ë‹¨ íƒ­">
    <a href="#home" class="tab" data-tab="home"><span class="ic">ğŸ </span><span>í™ˆ</span></a>
    <a href="#status" class="tab" data-tab="status"><span class="ic">ğŸ“Š</span><span>í˜„í™©</span></a>
    <a href="#assets" class="tab" data-tab="assets"><span class="ic">ğŸ’¼</span><span>ìì‚°</span></a>
    <a href="#experts" class="tab" data-tab="experts"><span class="ic">ğŸ‘¥</span><span>ì „ë¬¸ê°€</span></a>
    <a href="#mypage" class="tab" data-tab="mypage"><span class="ic">ğŸ‘¤</span><span>ë§ˆì´</span></a>
  </nav>

  <script>
    // ===== ê³µí†µ ìœ í‹¸: XSS ë°©ì§€ =====
    function escapeHtml(str) {
      return String(str).replace(/[&<>"']/g, (m) => ({
        '&':'&amp;', '<':'&lt;', '>':'&gt;', '"':'&quot;', "'":'&#039;'
      }[m]));
    }

    // 1) ì´ˆê¸° ë¼ìš°íŒ…
    if (!location.hash) location.hash = "#login";

    // 2) ë©”ë‰´ í† ê¸€ (ëª…ì‹œì ìœ¼ë¡œ ì—´ê¸°/ë‹«ê¸°)
    function toggleMenu(open) {
      const menu = document.getElementById('sideMenu');
      const overlay = document.getElementById('menuOverlay');
      const shouldOpen = (typeof open === 'boolean') ? open : !menu.classList.contains('active');
      menu.classList.toggle('active', shouldOpen);
      overlay.classList.toggle('active', shouldOpen);
    }

    // 3) íƒ­ ì „í™˜ (ì²´í¬ë¦¬ìŠ¤íŠ¸) - âœ… event ì˜ì¡´ ë²„ê·¸ ìˆ˜ì •
    function showTab(e, tabName) {
      document.querySelectorAll('.check-tab-btn').forEach(b => b.classList.remove('active'));
      if (e && e.currentTarget) e.currentTarget.classList.add('active');

      document.querySelectorAll('.check-content').forEach(c => c.classList.remove('active'));
      const target = document.getElementById('tab-' + tabName);
      if (target) target.classList.add('active');

      // aria-selected ì •ë¦¬(ì„ íƒì‚¬í•­ì´ì§€ë§Œ ì•ˆì •ì„±â†‘)
      document.querySelectorAll('.check-tab-btn').forEach(btn => btn.setAttribute('aria-selected', 'false'));
      if (e && e.currentTarget) e.currentTarget.setAttribute('aria-selected', 'true');
    }

    // 4) ìˆ«ì í¬ë§·íŒ…
    function formatNumber(el) {
      let val = el.value.replace(/[^0-9]/g, '');
      if (val) el.value = parseInt(val, 10).toLocaleString();
      else el.value = '';
    }

    // 5) ìƒì†ì„¸ ê³„ì‚° ë¡œì§
    function calculateInheritanceTax() {
      const asset = parseInt((document.getElementById('calc-asset').value || '').replace(/,/g, ''), 10) || 0;
      const debt = parseInt((document.getElementById('calc-debt').value || '').replace(/,/g, ''), 10) || 0;
      const deduction = parseInt((document.getElementById('calc-deduction').value || '').replace(/,/g, ''), 10) || 0;

      let base = Math.max(0, asset - debt - deduction);
      let tax = 0;

      if (base <= 100000000) tax = base * 0.1;
      else if (base <= 500000000) tax = base * 0.2 - 10000000;
      else if (base <= 1000000000) tax = base * 0.3 - 60000000;
      else if (base <= 3000000000) tax = base * 0.4 - 160000000;
      else tax = base * 0.5 - 460000000;

      document.getElementById('calc-base').innerText = base.toLocaleString();
      document.getElementById('calc-tax-amount').innerText = Math.floor(Math.max(0, tax)).toLocaleString() + "ì›";
      document.getElementById('calc-result').classList.add('show');
    }

    // 6) ì±„íŒ… ê¸°ëŠ¥ - âœ… Enter ì²˜ë¦¬ ê°œì„  + âœ… XSS ë°©ì§€
    function sendMessage(type) {
      const input = document.getElementById('input-' + type);
      const area = document.getElementById('msg-area-' + type);
      const raw = input.value || '';
      if (!raw.trim()) return;

      const safe = escapeHtml(raw);
      area.insertAdjacentHTML('beforeend', `<div class="chat-bubble-row me"><div class="chat-bubble me">${safe}</div></div>`);
      input.value = '';
      area.scrollTop = area.scrollHeight;

      setTimeout(() => {
        const reply = type === 'lawyer'
          ? "ë“±ê¸° ì„œë¥˜ëŠ” ì²´í¬ë¦¬ìŠ¤íŠ¸(í•„ìš” ì„œë¥˜)ì—ì„œ ìš°ì„  í™•ì¸í•´ë³´ì„¸ìš”."
          : "ê³µì œ í•­ëª©(ë°°ìš°ì/ì¼ê´„ ê³µì œ ë“±)ì„ ë¨¼ì € í™•ì¸í•˜ë©´ ì •í™•ë„ê°€ ì˜¬ë¼ê°‘ë‹ˆë‹¤.";
        const name = type === 'lawyer' ? "ê¹€ë²•ë¬´" : "ì´ì„¸ë¬´";
        const icon = type === 'lawyer' ? "ğŸ‘¨â€âš–ï¸" : "ğŸ‘©â€ğŸ’¼";

        area.insertAdjacentHTML('beforeend', `
          <div class="chat-bubble-row you">
            <div class="chat-profile">${icon}</div>
            <div>
              <div class="chat-name tiny muted">${name}</div>
              <div class="chat-bubble you">${escapeHtml(reply)}</div>
            </div>
          </div>
        `);
        area.scrollTop = area.scrollHeight;
      }, 900);
    }

    function handleEnter(e, type) {
      if (e.key === 'Enter') {
        e.preventDefault();
        sendMessage(type);
      }
    }

    // 7) Q&A ê¸€ì“°ê¸° - âœ… ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ë‹«ê¸° + âœ… XSS ë°©ì§€ + âœ… ì…ë ¥ ì´ˆê¸°í™”
    function openQnaWrite() {
      document.getElementById('writeModal').classList.add('active');
      document.getElementById('qna-title').focus();
    }
    function closeQnaWrite() {
      document.getElementById('writeModal').classList.remove('active');
      document.getElementById('qna-title').value = '';
      document.getElementById('qna-content').value = '';
      document.getElementById('qna-category').selectedIndex = 0;
    }

    function submitQuestion() {
      const title = (document.getElementById('qna-title').value || '').trim();
      const content = (document.getElementById('qna-content').value || '').trim();
      const cat = document.getElementById('qna-category').value || '#ê¸°íƒ€';

      if (!title || !content) return alert('ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.');

      const safeTitle = escapeHtml(title);
      const safeContent = escapeHtml(content);

      document.getElementById('qna-container').insertAdjacentHTML('afterbegin', `
        <div class="card" style="background:#f9fbff; border-color:#cfe3ff;">
          <div class="hstack space-between mb-10">
            <span class="tiny bold" style="color:var(--brand);">${escapeHtml(cat)} <span class="badge-new">NEW</span></span>
            <span class="status-wait">ë‹µë³€ëŒ€ê¸°</span>
          </div>
          <div class="bold">${safeTitle}</div>
          <div class="tiny muted mt-6">${safeContent}</div>
          <div class="tiny muted mt-6">ë°©ê¸ˆ ì „ ë“±ë¡</div>
        </div>
      `);

      closeQnaWrite();
      alert('ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. ì „ë¬¸ê°€ ë‹µë³€ì„ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.');
    }

    // 8) í•´ì‹œ ë³€ê²½ ì‹œ: íƒ­ë°” active ë™ê¸°í™” + ë©”ë‰´ ìë™ ë‹«ê¸° + ìŠ¤í¬ë¡¤ ì •ë¦¬
    function syncTabbar() {
      const hash = (location.hash || '#login').replace('#', '');
      const allowed = new Set(['home','status','assets','experts','mypage']);
      document.querySelectorAll('.tabbar .tab').forEach(tab => {
        const id = tab.getAttribute('data-tab');
        tab.classList.toggle('active', allowed.has(hash) && id === hash);
      });
    }

    function onRouteChange() {
      toggleMenu(false);                 // ì´ë™í•˜ë©´ ë©”ë‰´ ë‹«ê¸°
      syncTabbar();                      // íƒ­ë°” active ì—…ë°ì´íŠ¸
      window.scrollTo({ top: 0, behavior: 'instant' }); // í™”ë©´ ì´ë™ ì‹œ ìƒë‹¨ ê³ ì •
      // ë¡œê·¸ì¸ í™”ë©´ì—ì„œ íƒ­ë°”ëŠ” ê·¸ëŒ€ë¡œ ë³´ì´ëŠ”ë°, ë°ëª¨ë¼ì„œ ìœ ì§€. ìˆ¨ê¸°ê³  ì‹¶ìœ¼ë©´ ì—¬ê¸°ì„œ ì œì–´í•˜ë©´ ë¨.
    }

    window.addEventListener('hashchange', onRouteChange);
    // ìµœì´ˆ 1íšŒ
    onRouteChange();
  </script>
</body>
</html>
